{% extends "base.html" %}

{% block title %}My Design Requests - Purposefully Made KC{% endblock %}

{% block content %}
<div class="account-page">
    <div class="container">
        <div class="account-layout">
            <aside class="account-sidebar">
                <h2>My Account</h2>
                <nav class="account-nav">
                    <a href="{{ url_for('account.orders') }}" class="account-nav-link">Orders</a>
                    <a href="{{ url_for('account.my_designs') }}" class="account-nav-link">My Designs</a>
                    <a href="{{ url_for('custom_request.my_requests') }}" class="account-nav-link active">My Requests</a>
                    <a href="{{ url_for('account.addresses') }}" class="account-nav-link">Addresses</a>
                    <a href="{{ url_for('account.profile') }}" class="account-nav-link">Profile</a>
                    <a href="{{ url_for('auth.logout') }}" class="account-nav-link">Logout</a>
                </nav>
            </aside>
            
            <div class="account-content">
                <h1>My Design Requests</h1>
                <p class="page-sub">Requests you've submitted for us to recreate.</p>
                
                <a href="{{ url_for('custom_request.submit') }}" class="btn btn-primary btn-sm" style="margin-bottom: 1.5rem;">+ New Request</a>
                
                {% if requests %}
                <div class="requests-list">
                    {% for r in requests %}
                    <div class="request-card">
                        <div class="request-preview">
                            <img src="{{ url_for('static', filename=r.reference_file_path) }}" alt="Reference">
                        </div>
                        <div class="request-info">
                            <p class="request-desc">{{ r.description[:150] }}{% if r.description|length > 150 %}...{% endif %}</p>
                            <p class="request-meta">{{ r.created_at.strftime('%b %d, %Y') }} · <span class="badge badge-{{ r.status }}">{{ r.status.title() }}</span></p>
                            {% if r.created_design %}
                            <a href="{{ url_for('shop.index') }}" class="btn btn-outline btn-sm">Shop with this design →</a>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="empty-msg">No requests yet. <a href="{{ url_for('custom_request.submit') }}">Submit your first request</a>!</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
.account-layout { display: grid; grid-template-columns: 220px 1fr; gap: 2rem; }
@media (max-width: 768px) { .account-layout { grid-template-columns: 1fr; } }
.account-sidebar { background: #fff; padding: 1.5rem; border-radius: var(--border-radius); height: fit-content; box-shadow: var(--box-shadow); }
.account-nav { display: flex; flex-direction: column; gap: 0.25rem; }
.account-nav-link { padding: 0.5rem 0; color: var(--text-primary); }
.account-nav-link.active { font-weight: 600; color: var(--accent-color); }
.page-sub { color: var(--text-secondary); margin-bottom: 1rem; }
.requests-list { display: flex; flex-direction: column; gap: 1rem; }
.request-card { display: flex; gap: 1.5rem; padding: 1rem; background: #fff; border-radius: var(--border-radius); border: 1px solid var(--border-color); }
.request-preview { width: 80px; height: 80px; flex-shrink: 0; background: var(--ivory-silk); border-radius: 8px; overflow: hidden; }
.request-preview img { width: 100%; height: 100%; object-fit: contain; }
.request-desc { margin-bottom: 0.5rem; }
.request-meta { font-size: 0.9rem; color: var(--text-secondary); }
.badge-pending { background: rgba(245, 158, 11, 0.2); color: #d97706; }
.badge-completed { background: rgba(16, 185, 129, 0.2); color: #059669; }
.badge-declined { background: rgba(239, 68, 68, 0.2); color: #dc2626; }
.empty-msg { color: var(--text-secondary); }
</style>
{% endblock %}
